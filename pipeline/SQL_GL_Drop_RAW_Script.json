{
	"name": "SQL_GL_Drop_RAW_Script",
	"properties": {
		"activities": [
			{
				"name": "Drop RAW GL Tables Script",
				"type": "Script",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "SqlServerArgent",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "NonQuery",
							"text": "/*==================================================================================================================*\r\n * Project:     Argent                                                                                              *\r\n * Purpose:     Drop RAW tables                                                                                     *\r\n * Description: Drop previously imported GL tables to prevent duplications in PK columns.                            *\r\n * Date:        22/08/2022                                                                                          *\r\n * Version:     1.0                                                                                                 *                                                                          \r\n *==================================================================================================================*\r\n\r\n * Updates:                                                                                                         *\r\n\r\n * Date     | Version | Author      | Change made                                                                   *\r\n\r\n * -----------------------------------------------------------------------------------------------------------------*\r\n\r\n * --/--/-- |  1.-    |             |                                                                               *\r\n\r\n *          |         |             |                                                                               *\r\n\r\n *==================================================================================================================*/\r\n\r\n/********************************************************************************************************\r\n    Step 1.1:   Drop tables\r\n********************************************************************************************************/\r\n\r\n\r\n    DECLARE @DropTableStatement NVARCHAR(MAX)\r\n\r\n    DECLARE Cur2 CURSOR READ_ONLY\r\n\r\n    FOR\r\n\r\n            SELECT  'DROP TABLE [RAW].[' + TABLE_NAME + ']'\r\n\r\n            FROM    INFORMATION_SCHEMA.TABLES\r\n\r\n            WHERE   TABLE_SCHEMA = 'RAW'\r\n\r\n            AND     TABLE_TYPE = 'BASE TABLE'\r\n\r\n           AND    ( TABLE_NAME LIKE 'O.GL%' or TABLE_NAME LIKE 'O.AP_%' or TABLE_NAME  LIKE 'O.RA_CUST%' or TABLE_NAME  LIKE 'O.FND%' or TABLE_NAME  LIKE 'O.XLA%'\r\n                        or TABLE_NAME LIKE '%DISTRIBUTION%' or TABLE_NAME LIKE '%HZ_CUST%'or TABLE_NAME LIKE '%RCV%' or TABLE_NAME LIKE '%CST_%' OR TABLE_NAME LIKE '%WSH_%'\r\n                        OR TABLE_NAME LIKE '%DOCUMENT_REFERENCES%' OR TABLE_NAME LIKE 'O.DOO%' OR TABLE_NAME LIKE 'O.INV%' OR TABLE_NAME LIKE '%PO_LINE_LOCATIONS_ALL%'\r\n                        OR TABLE_NAME LIKE '%Join%' OR TABLE_NAME LIKE '%POR_%' OR TABLE_NAME LIKE '%O.AR_%' OR TABLE_NAME LIKE '%O.WIE%' OR TABLE_NAME LIKE '%O.MSC%')\r\n\r\n\r\n    OPEN Cur2\r\n    FETCH NEXT FROM Cur2 INTO @DropTableStatement\r\n    WHILE @@FETCH_STATUS = 0\r\n          BEGIN\r\n                PRINT 'Executing ' + @DropTableStatement\r\n                EXECUTE sp_executesql @DropTableStatement\r\n                FETCH NEXT FROM Cur2 INTO @DropTableStatement\r\n          END\r\n    CLOSE Cur2\r\n    DEALLOCATE Cur2\r\n"
						}
					]
				}
			}
		],
		"folder": {
			"name": "Finance"
		},
		"annotations": [],
		"lastPublishTime": "2022-12-16T10:15:56Z"
	},
	"type": "Microsoft.DataFactory/factories/pipelines"
}