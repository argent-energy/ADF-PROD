{
	"name": "SQL_GIT_Tables",
	"properties": {
		"activities": [
			{
				"name": "GIT Tables",
				"type": "Script",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "SqlServerArgent",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "NonQuery",
							"text": " /********************************************************************************************************\r\n\tStep 6.1:\tCreate GIT Inventory table\r\n********************************************************************************************************/\t\r\n\r\n\tIF OBJECT_ID('SupplyChain.GIT_Inventory','U') IS NOT NULL DROP TABLE SupplyChain.GIT_Inventory\r\n\tSELECT\t\t*\r\n\tINTO\t\tSupplyChain.GIT_Inventory\r\n\tFROM\t\tSupplyChain.InventoryQuantityAndValue\r\n\tWHERE\t\t[Subinventory] = 'GIT'\r\n\r\n /********************************************************************************************************\r\n\tStep 6.2:\tCreate GIT purchase contract table \r\n********************************************************************************************************/\t\r\n\r\n\tIF OBJECT_ID('SupplyChain.GIT_PurchaseContracts','U') IS NOT NULL DROP TABLE SupplyChain.GIT_PurchaseContracts\r\n\tSELECT\t\t*\r\n\tINTO\t\tSupplyChain.GIT_PurchaseContracts\r\n\tFROM\t\tSupplyChain.PurchaseContracts\r\n\tWHERE\t\t[Blanket Purchase Agreement Number] IN (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tSELECT\t\tDISTINCT COALESCE([Agreement/Sales Contract Number],[Order Number])\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tFROM\t\tSupplyChain.ShippingContracts\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\r\n /********************************************************************************************************\r\n\tStep 6.3:\tCreate GIT sales contract table\r\n********************************************************************************************************/\t\r\n\r\n\tIF OBJECT_ID('SupplyChain.GIT_SalesContracts','U') IS NOT NULL DROP TABLE SupplyChain.GIT_SalesContracts\r\n\tSELECT\t\t*\r\n\tINTO\t\tSupplyChain.GIT_SalesContracts\r\n\tFROM\t\tSupplyChain.SalesContracts\r\n\tWHERE\t\t[Sales Contract Number] IN\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\tSELECT\t\tDISTINCT COALESCE([Agreement/Sales Contract Number],[Order Number])\r\n\t\t\t\t\t\t\t\t\t\t\t\tFROM\t\tSupplyChain.ShippingContracts\r\n\t\t\t\t\t\t\t\t\t\t\t)\r\n\r\n /********************************************************************************************************\r\n\tStep 6.4:\tCreate list of relevant IMO numbers\r\n********************************************************************************************************/\t\r\n\r\n\tIF OBJECT_ID('SupplyChain.GIT_IMO_Numbers','U') IS NOT NULL DROP TABLE SupplyChain.GIT_IMO_Numbers\r\n\tSELECT\t\tDISTINCT CASE\r\n\t\t\t\t\tWHEN [Vessel Transfer Indicator] = 'X'\r\n\t\t\t\t\t\tTHEN [Vessel IMO]\r\n\t\t\t\t\tELSE ISNULL([Mothervessel IMO],[Vessel IMO])\r\n\t\t\t\tEND AS [IMO]\r\n\tINTO\t\t[SupplyChain].[GIT_IMO_Numbers]\r\n\tFROM\t\t(\r\n\t\t\t\t\tSELECT\t\tDISTINCT\t[ATA Date]\r\n\t\t\t\t\t,\t\t\t[Vessel IMO]\r\n\t\t\t\t\t,\t\t\t[Mothervessel IMO]\r\n\t\t\t\t\t,\t\t\t[Vessel Transfer Indicator]\r\n\t\t\t\t\tFROM\t\tSupplyChain.Shipping\r\n\t\t\t\t\tWHERE\t\t[Vessel IMO] <> ''\r\n\t\t\t\t\tAND\t\t\tISNULL([Vessel IMO],[Mothervessel IMO]) IS NOT NULL\r\n\t\t\t\t\tAND\t\t\t[Live Shipment Indicator] = 1\r\n\t\t\t\t) x"
						}
					]
				}
			}
		],
		"folder": {
			"name": "Supply Chain"
		},
		"annotations": []
	}
}