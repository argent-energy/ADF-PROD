{
	"name": "SQL_Exp_And_Pos_Drop_RAW_Script",
	"properties": {
		"activities": [
			{
				"name": "Exposure And Position Drop RAW Tables Script",
				"type": "Script",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "SqlServerArgent",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "NonQuery",
							"text": "/*==================================================================================================================*\r\n * Project:\t\tArgent\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t*\r\n * Purpose:\t\tDrop RAW tables\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t*\r\n * Description:\tDrop the RAW tables used to create the Core tables.\t\t\t\t\t\t\t\t\t\t\t\t\t*\r\n * Date:        29/07/2022\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t*\r\n * Version:     1.0\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t*\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n *==================================================================================================================*\r\n * Updates:\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t*\r\n * Date\t\t| Version | Author\t\t| Change made\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t*\r\n * -----------------------------------------------------------------------------------------------------------------*\r\n * --/--/-- |  1.-\t  |\t\t\t\t|\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t*\r\n *\t\t\t|\t\t  |\t\t\t\t|\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t*\r\n *==================================================================================================================*/\r\n \r\n\r\n/********************************************************************************************************\r\n\tStep 1.1:\tDrop tables\r\n********************************************************************************************************/\r\n\r\n\tDECLARE @DropTableStatement NVARCHAR(MAX)\r\n\tDECLARE Cur2 CURSOR READ_ONLY\r\n\tFOR\r\n\t\t\tSELECT  'DROP TABLE [RAW].[' + TABLE_NAME + ']'\r\n\t\t\tFROM    INFORMATION_SCHEMA.TABLES\r\n\t\t\tWHERE   TABLE_SCHEMA = 'RAW'\r\n\t\t\tAND\t\tTABLE_TYPE = 'BASE TABLE' \r\n\t\t\tAND\t\t(TABLE_NAME LIKE 'O.%' AND TABLE_NAME NOT LIKE 'O.GL%' AND TABLE_NAME NOT LIKE 'O.AP_%' AND TABLE_NAME NOT LIKE 'O.RA_CUST%' \r\n\t\t\t        AND TABLE_NAME NOT LIKE 'O.FND%' AND TABLE_NAME NOT LIKE 'O.XLA%' AND TABLE_NAME NOT LIKE '%DISTRIBUTION%' AND TABLE_NAME NOT LIKE '%HZ_CUST%' \r\n\t\t\t\t\tAND TABLE_NAME NOT LIKE '%RCV%' AND TABLE_NAME NOT LIKE '%CST_%' AND TABLE_NAME NOT LIKE '%WSH_%' AND TABLE_NAME NOT LIKE '%DOCUMENT_REFERENCES%'\r\n\t\t\t\t\tAND TABLE_NAME NOT LIKE 'O.DOO%' AND TABLE_NAME NOT LIKE 'O.INV%' AND TABLE_NAME NOT LIKE '%PO_LINE_LOCATIONS_ALL%' AND TABLE_NAME NOT LIKE '%Join%'\r\n\t\t\t\t\tAND TABLE_NAME NOT LIKE '%POR_%' AND TABLE_NAME NOT LIKE '%O.AR_%' AND TABLE_NAME NOT LIKE '%O.WIE%' AND TABLE_NAME NOT LIKE '%O.MSC%')\r\n\r\n\r\n\tOPEN Cur2\r\n\tFETCH NEXT FROM Cur2 INTO @DropTableStatement\r\n\tWHILE @@FETCH_STATUS = 0\r\n\t\t  BEGIN\r\n\t\t\t\tPRINT 'Executing ' + @DropTableStatement\r\n\t\t\t\tEXECUTE sp_executesql @DropTableStatement\r\n\t\t\t\tFETCH NEXT FROM Cur2 INTO @DropTableStatement\r\n\t\t  END\r\n\tCLOSE Cur2\r\n\tDEALLOCATE Cur2"
						}
					]
				}
			}
		],
		"folder": {
			"name": "Trade/Exp and Pos"
		},
		"annotations": [],
		"lastPublishTime": "2022-12-16T10:23:23Z"
	},
	"type": "Microsoft.DataFactory/factories/pipelines"
}